<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador CRC - Contabilidade</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a5276 0%, #2c3e50 100%);
            color: #333;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 700px;
            padding: 30px;
            position: relative;
            overflow: hidden;
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeaea;
        }
        
        h1 {
            color: #1a5276;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .discipline-selector {
            text-align: center;
            padding: 20px 0;
        }
        
        .discipline-title {
            font-size: 20px;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .disciplines-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .discipline-option {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background-color: #f8f9fa;
        }
        
        .discipline-option:hover {
            background-color: #e8f4fc;
            border-color: #3498db;
            transform: translateY(-3px);
        }
        
        .discipline-option.selected {
            background-color: #d1edff;
            border-color: #3498db;
            font-weight: bold;
        }
        
        .start-button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 0 auto;
            display: block;
        }
        
        .start-button:hover {
            background-color: #2980b9;
        }
        
        .start-button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        
        .progress {
            display: flex;
            margin-left: auto; /* empurra o elemento para a direita */
            margin-bottom: 20px;
            font-weight: 500;
            color: #7f8c8d;
        }

        .current-question {
            color: black;
            padding: 8px 2px;
            border-radius: 4px;
        }

        .total-questions {
            color: black;
            padding: 8px 2px;
            border-radius: 4px;
        }
        
        .question-container {
            margin-bottom: 25px;
        }
        
        .question-text {
            font-size: 18px;
            line-height: 1.5;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .option:hover {
            background-color: #f8f9fa;
            border-color: #c0c0c0;
        }
        
        .option-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .option-text {
            flex: 1;
        }
        
        .correct {
            background-color: #e6f7ee;
            border-color: #2ecc71;
        }
        
        .correct .option-circle {
            background-color: #2ecc71;
            color: white;
        }
        
        .incorrect {
            background-color: #fde9e9;
            border-color: #e74c3c;
        }
        
        .incorrect .option-circle {
            background-color: #e74c3c;
            color: white;
        }
        
        .next-button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            display: block;
            margin-left: auto;
            transition: background-color 0.3s;
        }
        
        .next-button:hover {
            background-color: #2980b9;
        }
        
        .next-button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        
        .hidden {
            display: none;
        }
        
        .score-container {
            text-align: center;
            padding: 20px;
        }
        
        .score-title {
            font-size: 24px;
            margin-bottom: 15px;
            color: #1a5276;
        }
        
        .score-value {
            font-size: 48px;
            font-weight: bold;
            color: #2ecc71;
            margin-bottom: 20px;
        }
        
        .restart-button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .restart-button:hover {
            background-color: #2980b9;
        }
        
        .back-button {
            background-color: #95a5a6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            margin-right: 10px;
            transition: background-color 0.3s;
        }
        
        .back-button:hover {
            background-color: #7f8c8d;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 22px;
            }
            
            .question-text {
                font-size: 16px;
            }
            
            .disciplines-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Simulador CRC - Contabilidade</h1>
            <p class="subtitle">Prepare-se para o exame de CRC selecionando as disciplinas</p>
        </header>
        
        <!-- Tela de sele√ß√£o de disciplina -->
        <div id="discipline-screen">
            <div class="discipline-selector">
                <h2 class="discipline-title">Selecione a Disciplina</h2>
                <div class="disciplines-container" id="disciplines-container">
                    <!-- As op√ß√µes de disciplina ser√£o geradas pelo JavaScript -->
                </div>
                <button id="start-button" class="start-button" disabled>Iniciar Simulado</button>
            </div>
        </div>
        
        <!-- Tela de quest√µes (inicialmente oculta) -->
        <div id="quiz-screen" class="hidden">
            <button id="back-button" class="back-button">Voltar</button>
            <div class="progress">
                <text class="current-question">Quest√£o 1</text>
                <text class="total-questions">de 5</text>
            </div>
            
            <div class="question-container">
                <p class="question-text"></p>
                
                <div class="options-container">
                    <div class="option" data-option="A">
                        <div class="option-circle">A</div>
                        <div class="option-text"></div>
                    </div>
                    <div class="option" data-option="B">
                        <div class="option-circle">B</div>
                        <div class="option-text"></div>
                    </div>
                    <div class="option" data-option="C">
                        <div class="option-circle">C</div>
                        <div class="option-text"></div>
                    </div>
                    <div class="option" data-option="D">
                        <div class="option-circle">D</div>
                        <div class="option-text"></div>
                    </div>
                </div>
            </div>
            
            <button class="next-button hidden">Pr√≥xima</button>
        </div>
        
        <!-- Tela de resultados (inicialmente oculta) -->
        <div class="score-container hidden">
            <h2 class="score-title">Simulado Finalizado!</h2>
            <div class="score-value">0/5</div>
            <button class="restart-button">Fazer Novo Simulado</button>
        </div>
    </div>

    <script>
    // Extrair disciplinas √∫nicas
    let disciplines = [];

    // Vari√°veis de controle
    let currentQuestionIndex = 0;
    let score = 0;
    let userAnswers = [];
    let selectedDiscipline = null;
    let filteredQuestions = [];
    let questions = [];

    // Elementos do DOM
    const disciplineScreen = document.getElementById('discipline-screen');
    const quizScreen = document.getElementById('quiz-screen');
    const disciplinesContainer = document.getElementById('disciplines-container');
    const startButton = document.getElementById('start-button');
    const backButton = document.getElementById('back-button');
    const questionTextElement = document.querySelector('.question-text');
    const optionElements = document.querySelectorAll('.option');
    const optionTextElements = document.querySelectorAll('.option-text');
    const nextButton = document.querySelector('.next-button');
    const currentQuestionElement = document.querySelector('.current-question');
    const totalQuestionsElement = document.querySelector('.total-questions');
    const questionContainer = document.querySelector('.question-container');
    const scoreContainer = document.querySelector('.score-container');
    const scoreValueElement = document.querySelector('.score-value');
    const restartButton = document.querySelector('.restart-button');

    // Inicializar o aplicativo
    async function init() {
        questions = await loadQuestionsArq(); // üîπ esperar carregar o JSON
        console.log("Quest√µes carregadas:", questions);

        // Garante que n√£o tenta mapear se o arquivo est√° vazio
        if (!questions || questions.length === 0) {
            alert("Nenhuma quest√£o encontrada no arquivo JSON!");
            return;
        }

        disciplines = [...new Set(questions.map(q => q.discipline))];
        renderDisciplineOptions();

        // Adicionar event listeners
        startButton.addEventListener('click', startQuiz);
        backButton.addEventListener('click', backToDisciplineSelection);
        nextButton.addEventListener('click', nextQuestion);
        restartButton.addEventListener('click', restartQuiz);
    }

    // Carregar m√∫ltiplos arquivos JSON
    async function loadQuestionsArq() {
        const files = [
            'questions_crc_2021_1.json',
            'questions_crc_2021_2.json',
            'questions_crc_2022_1.json',
            'questions_crc_2022_2.json',
            'questions_crc_2023_1.json',
            'questions_crc_2023_2.json',
            'questions_crc_2024_1.json',
            'questions_crc_2024_2.json',
            'questions_crc_2025_1.json' // adicione quantos arquivos quiser
        ];

        try {
            // Cria array de promises para cada fetch
            const fetchPromises = files.map(file => 
                fetch(file).then(res => {
                    if (!res.ok) throw new Error(`Erro ao carregar ${file}`);
                    return res.json();
                })
            );

            // Espera todas as promises completarem
            const results = await Promise.all(fetchPromises);

            // Combina todos os arrays em um √∫nico array
            return results.flat(); 
        } catch (err) {
            console.error(err);
            return [];
        }
    }


    // Renderizar op√ß√µes de disciplina
    function renderDisciplineOptions() {
        disciplinesContainer.innerHTML = '';

        disciplines.forEach(discipline => {
            const optionElement = document.createElement('div');
            optionElement.className = 'discipline-option';
            optionElement.textContent = discipline;
            optionElement.addEventListener('click', () => selectDiscipline(discipline, optionElement));
            disciplinesContainer.appendChild(optionElement);
        });

        // Adicionar op√ß√£o para todas as disciplinas
        const allOption = document.createElement('div');
        allOption.className = 'discipline-option';
        allOption.textContent = "Todas as Disciplinas";
        allOption.addEventListener('click', () => selectDiscipline(null, allOption));
        disciplinesContainer.appendChild(allOption);
    }

    // Selecionar disciplina
    function selectDiscipline(discipline, element) {
        // Remover sele√ß√£o anterior
        document.querySelectorAll('.discipline-option').forEach(opt => {
            opt.classList.remove('selected');
        });

        // Marcar como selecionado
        element.classList.add('selected');

        selectedDiscipline = discipline;
        startButton.disabled = false;
    }

    // Iniciar o quiz
    function startQuiz() {
        // Filtrar quest√µes pela disciplina selecionada
        if (selectedDiscipline) {
            filteredQuestions = questions.filter(q => q.discipline === selectedDiscipline);
        } else {
            filteredQuestions = [...questions]; // Todas as quest√µes
        }

        if (filteredQuestions.length === 0) {
            alert('N√£o h√° quest√µes dispon√≠veis para a disciplina selecionada.');
            return;
        }

        // Embaralhar quest√µes
        shuffleArray(filteredQuestions);

        // Atualizar o total de quest√µes
        totalQuestionsElement.textContent = `de ${filteredQuestions.length}`;

        // Atualizar o total de quest√µes
        totalQuestionsElement.textContent = `de ${filteredQuestions.length}`;

        // Mostrar tela do quiz e esconder seletor de disciplina
        disciplineScreen.classList.add('hidden');
        quizScreen.classList.remove('hidden');

        // Carregar primeira quest√£o
        loadQuestion();

        // Adicionar event listeners para as op√ß√µes
        optionElements.forEach(option => {
            option.addEventListener('click', selectOption);
        });
    }

    // Voltar para a sele√ß√£o de disciplina
    function backToDisciplineSelection() {
        quizScreen.classList.add('hidden');
        scoreContainer.classList.add('hidden');
        disciplineScreen.classList.remove('hidden');

        // Resetar vari√°veis
        currentQuestionIndex = 0;
        score = 0;
        userAnswers = [];
        selectedDiscipline = null;
        filteredQuestions = [];
    }

    // Embaralhar array (algoritmo Fisher-Yates)
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // Carregar quest√£o atual
    function loadQuestion() {
        const currentQuestion = filteredQuestions[currentQuestionIndex];
        questionTextElement.textContent = currentQuestion.question;

        currentQuestionElement.textContent = `Quest√£o ${currentQuestionIndex + 1}`;

        // Preencher op√ß√µes
        optionTextElements[0].textContent = currentQuestion.options.A;
        optionTextElements[1].textContent = currentQuestion.options.B;
        optionTextElements[2].textContent = currentQuestion.options.C;
        optionTextElements[3].textContent = currentQuestion.options.D;

        // Resetar estilos das op√ß√µes
        optionElements.forEach(option => {
            option.classList.remove('correct', 'incorrect');
            option.style.pointerEvents = 'auto';
        });

        // Esconder bot√£o pr√≥ximo
        nextButton.classList.add('hidden');
    }

    // Selecionar uma op√ß√£o
    function selectOption(event) {
        const selectedOption = event.currentTarget;
        const selectedAnswer = selectedOption.getAttribute('data-option');
        const correctAnswer = filteredQuestions[currentQuestionIndex].correctAnswer;

        // Desabilitar clique em outras op√ß√µes
        optionElements.forEach(option => {
            option.style.pointerEvents = 'none';

            if (option.getAttribute('data-option') === correctAnswer) {
                option.classList.add('correct');
            }
        });

        // Verificar se a resposta est√° correta
        if (selectedAnswer === correctAnswer) {
            selectedOption.classList.add('correct');
            score++;
        } else {
            selectedOption.classList.add('incorrect');
        }

        // Registrar resposta do usu√°rio
        userAnswers[currentQuestionIndex] = {
            question: filteredQuestions[currentQuestionIndex].question,
            selected: selectedAnswer,
            correct: correctAnswer,
            isCorrect: selectedAnswer === correctAnswer
        };

        // Mostrar bot√£o pr√≥ximo
        nextButton.classList.remove('hidden');
    }

    // Pr√≥xima quest√£o
    function nextQuestion() {
        currentQuestionIndex++;

        if (currentQuestionIndex < filteredQuestions.length) {
            loadQuestion();
        } else {
            showScore();
        }
    }

    // Mostrar pontua√ß√£o final
    function showScore() {
        quizScreen.classList.add('hidden');
        scoreContainer.classList.remove('hidden');
        scoreValueElement.textContent = `${score}/${filteredQuestions.length}`;
    }

    // Reiniciar o quiz
    function restartQuiz() {
        currentQuestionIndex = 0;
        score = 0;
        userAnswers = [];

        scoreContainer.classList.add('hidden');
        quizScreen.classList.remove('hidden');

        // Embaralhar quest√µes novamente
        shuffleArray(filteredQuestions);

        loadQuestion();
    }

    // Iniciar o aplicativo quando a p√°gina carregar
    window.addEventListener('load', init);
</script>

</body>
</html>